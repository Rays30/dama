/*
 * Consolidated Dama Game Styles
 * This file combines your original styles with the new design recommendations.
 *
 * Key changes:
 * - New global color variables and Poppins font.
 * - Redesigned board and pieces.
 * - Frosted glass effect for modals, consistent button styling.
 * - Smooth fade/slide animations for modals.
 * - Responsive adjustments using the new color scheme.
 * - Preserved existing game logic and online menu specific styles,
 *   but updated their colors to match the new dark theme.
 *
 * IMPORTANT: This version also applies the frosted glass effect to the main menu screens.
 */

/* --- Root Variables (Updated from new variables.css and existing) --- */
:root {
    /* Colors (New Theme - dark blue-gray, emerald green accent, amber highlight) */
    --bg-dark: #1a202c; /* Main background */
    --bg-panel: rgba(26, 32, 44, 0.8); /* For semi-transparent panels/modals if needed */
    --accent: #38a169; /* Emerald green for actions */
    --accent-highlight: #dd6b20; /* Amber/Orange for hover/highlights */
    --text-light: #edf2f7; /* Light text color */

    /* Board & Piece Colors (Adjusted from original to new theme) */
    --board-background: #4a5568; /* Board container background */
    --dark-square: #2d3748; /* Dark squares (formerly #7F5539) */
    --light-square: #4a5568; /* Light squares (formerly #CDB48F) */
    --piece-red-color: #e53e3e; /* Brighter red for pieces (formerly #B22222) */
    --piece-blue-color: #edf2f7; /* Light white for opponent pieces (formerly #4682B4) */
    --king-highlight: #ecc94b; /* Gold highlight for kings */

    /* Highlight & Selection */
    --highlight-color: rgba(56, 161, 105, 0.7); /* Greenish highlight for moves (new accent) */
    --capture-highlight-color: rgba(237, 2, 2, 0.7); /* Red for captures (adjusted for contrast) */
    --selected-border: 4px solid #38a169; /* Accent color border for selected piece */

    /* Fonts */
    --font-body: 'Poppins', sans-serif;
    --font-heading: 'Poppins', sans-serif;

    /* Responsive Defaults (from original, potentially overridden by JS) */
    --board-size: 640px; /* Default desktop size */
    --square-size: 80px; /* This will be dynamically overridden by JS for responsive board */
    --piece-size: 64px; /* This will be dynamically overridden by JS for responsive board */
}

/* --- Global Body Styles (Updated from new base.css) --- */
body {
    background-color: var(--bg-dark);
    color: var(--text-light);
    font-family: var(--font-body);
    display: flex; /* Kept for centering game-container */
    justify-content: center; /* Kept for centering game-container */
    align-items: center; /* Kept for centering game-container */
    min-height: 100vh;
    margin: 0;
    overflow-x: hidden;
    line-height: 1.6; /* From new base.css */
}

/* --- Game Container (Kept mostly from original, colors updated) --- */
#game-container {
    padding: 15px;
    text-align: center;
    position: relative;
    overflow: hidden;
    width: 100vw;
    min-height: 100vh;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/* --- Titles (Updated from new base.css and existing) --- */
h1 {
    color: var(--accent-highlight); /* Using new highlight color */
    margin: 10px 0 20px 0;
    font-size: 2.5em;
    font-family: var(--font-heading);
    font-weight: 600;
}

h2 {
    color: var(--text-light); /* Using new text color */
    margin-bottom: 20px;
    font-size: 2em;
    font-family: var(--font-heading);
    font-weight: 600;
}

/* --- Screen Transitions (Retained from original, new animations are for modals) --- */
.screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: transparent; /* Make screen background transparent to allow blur to show */
    display: none; /* FIX: Hide all screens by default */
    flex-direction: column;
    justify-content: center;
    align-items: center;
    transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
    transform: translateX(100%);
    opacity: 0;
    z-index: 10;
    padding: 20px;
    box-sizing: border-box;
    border-radius: 10px; /* From original */
    pointer-events: none;
}

.screen.active {
    display: flex; /* FIX: Show active screen with flex */
    transform: translateX(0);
    opacity: 1;
    z-index: 20;
    pointer-events: auto;
}

/* Menu screens - now styled as frosted glass cards */
#main-menu, #single-player-menu, #online-menu, #result-screen {
    background: rgba(255, 255, 255, 0.05); /* Frosted glass background for screens */
    backdrop-filter: blur(10px); /* Frosted glass blur */
    -webkit-backdrop-filter: blur(10px); /* Webkit support */
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6); /* New shadow for screens */
    border-radius: 12px; /* New border-radius for screens */
    max-width: 680px; /* From original */
    width: 95vw; /* From original */
    min-height: 50vh; /* From original */
    margin: 20px auto; /* From original */
    position: relative;
    /* REMOVED: opacity: 1; transform: none; from here. Let .screen.active handle the active states dynamically. */
}

/* Override .screen properties for stacking behavior within #game-container */
/* This rule is now primarily for setting `position: relative` for menu cards and could be merged up. */
/* But keeping it for clarity that these are treated as "cards" within the flow. */
#main-menu.screen, #single-player-menu.screen, #online-menu.screen, #result-screen.screen {
    position: relative;
    /* REMOVED: transform: none; opacity: 1; display: none; */
    /* These are now handled by the general `.screen` and `.screen.active` rules */
}

#main-menu.screen.active, #single-player-menu.screen.active, #online-menu.screen.active, #result-screen.screen.active {
    /* REMOVED: display: flex; */
    /* This is now handled by the general `.screen.active` rule */
    animation: fade-in 0.5s forwards;
}

/* For game-screen, keep absolute positioning for full overlay */
#game-screen.screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--bg-dark); /* Using new background color */
    backdrop-filter: none; /* Ensure game screen doesn't blur itself */
    -webkit-backdrop-filter: none;
    z-index: 25; /* FIX: Ensure game-screen is on top when active */
}

@keyframes fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* --- Buttons (Updated from new components/buttons.css and original specifics) --- */
button, .button { /* Added .button for consistency */
    background-color: var(--accent);
    color: var(--text-light);
    border: none;
    border-radius: 6px; /* Slightly less rounded than original 8px */
    padding: 0.75em 1.5em; /* Adjusted padding */
    font-size: 1rem; /* Adjusted font size */
    cursor: pointer;
    transition: background 0.25s ease, transform 0.2s ease; /* Combined transitions */
    min-width: 180px; /* From original */
    width: 80%; /* From original */
    max-width: 300px; /* From original */
    box-sizing: border-box; /* From original */
    font-weight: 600; /* Adjusted from bold to 600 for Poppins */
    font-family: var(--font-heading); /* Applied new font */
    box-shadow: 0 4px 10px rgba(0,0,0,0.3); /* From original */
    margin: 10px; /* From original */
}

button:hover, .button:hover {
    background-color: var(--accent-highlight);
    transform: scale(1.05); /* From original */
}

button:focus, .button:focus {
    outline: 2px solid var(--accent-highlight);
    outline-offset: 2px;
}

button.back-button {
    background-color: #7f8c8d; /* Kept original grey */
}
button.back-button:hover {
    background-color: #95a5a6; /* Kept original grey hover */
}

#btn-undo {
    background-color: var(--accent-highlight); /* Using new highlight color */
    min-width: unset;
    padding: 8px 15px;
    font-size: 0.9em;
}
#btn-undo:hover {
    background-color: #f1c40f; /* Slightly different yellow hover */
}

/* --- Game Info Bar (Kept mostly original, colors updated) --- */
#game-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    color: var(--text-light);
    font-weight: 600; /* Adjusted to 600 */
    font-size: 1.2em;
    padding: 0 5px;
    width: 100%;
    flex-wrap: wrap;
    gap: 5px;
}

#turn-indicator {
    padding: 5px 10px;
    border-radius: 5px;
    min-width: 100px;
    text-align: center;
    flex-shrink: 0;
    font-weight: 600; /* Adjusted to 600 */
}
#turn-indicator.red { background-color: var(--piece-red-color); }
#turn-indicator.blue { background-color: var(--piece-blue-color); color: var(--bg-dark);} /* Dark text on light piece color */

#message-area {
    flex-grow: 1;
    text-align: center;
    margin: 0 5px;
    color: var(--accent-highlight); /* Using new highlight color */
    min-width: 150px;
}

/* --- Board (Updated from new board.css and original responsive properties) --- */
#board-container.board { /* Added .board class to match HTML and new CSS */
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    grid-template-rows: repeat(8, 1fr); /* Added for consistency */
    width: 90vmin; /* Responsive width based on viewport min dimension (from original) */
    height: 90vmin; /* Keep it square (from original) */
    background: var(--board-background); /* New board background color */
    padding: 8px; /* New padding */
    border-radius: 8px; /* New border radius */
    border: 4px solid var(--dark-square); /* Border from original, color updated */
    box-sizing: border-box; /* From original */
    margin: auto; /* From original */
    position: relative; /* From original */
    gap: 2px; /* New gap for grid */
    box-shadow: 0 6px 16px rgba(0,0,0,0.4); /* From original */
}

/* Board squares (Updated from new board.css and original logic) */
.square {
    position: relative;
    padding-top: 100%; /* From new board.css, maintains aspect ratio */
    background: linear-gradient(135deg, var(--light-square) 0%, var(--dark-square) 100%); /* New gradient for squares */
    box-shadow: inset 0 0 4px rgba(0, 0, 0, 0.5); /* New inner shadow */
}

/* Alternating square colors */
.board .square:nth-child(odd) { /* From new board.css */
  background-color: var(--dark-square);
}
.board .square:nth-child(even) { /* From new board.css */
  background-color: var(--light-square);
}

/* Original light/dark square classes will be effectively overwritten by nth-child,
   but kept for backwards compatibility if JS still assigns them.
   Ideally, JS only relies on grid and nth-child for basic styling. */
.square.dark { /* Kept for potential JS assignment, but overwritten by nth-child */
    background-color: var(--dark-square);
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.2);
}
.square.light { /* Kept for potential JS assignment, but overwritten by nth-child */
    background-color: var(--light-square);
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.1);
}

/* --- Pieces (Updated from new board.css and original specifics) --- */
.piece {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 70%; /* New width */
    height: 70%; /* New height */
    background-color: var(--piece-red-color); /* Default to red, will be overridden by .dark */
    border-radius: 50%;
    transform: translate(-50%, -50%); /* For centering */
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.5); /* New shadow */
    cursor: grab; /* From original */
    transition: transform 0.3s ease, border 0.1s ease; /* From original and new animations.css */
    z-index: 100; /* From original */
    display: flex; /* From original */
    justify-content: center; /* From original */
    align-items: center; /* From original */
}

.piece.red { /* Updated to new red piece color, border adjusted */
    background-color: var(--piece-red-color);
    border: 3px solid #8e1c1c;
}

.piece.dark { /* New class from board.css, used for opponent color (blue in original context) */
    background-color: var(--piece-blue-color);
    border: 3px solid #3a6c95;
}
/* If your JS uses .piece.blue, you can keep it or rename to .piece.dark */
.piece.blue { /* Kept for compatibility, if your JS assigns 'blue' class explicitly */
    background-color: var(--piece-blue-color);
    border: 3px solid #3a6c95;
}

.piece.selected { /* Updated to new accent color for border */
    border: var(--selected-border);
    transform: translate(-50%, -50%) scale(1.1);
    cursor: grabbing;
    z-index: 101;
}

.piece.king { /* New outline and shadow from board.css */
  outline: 3px solid var(--king-highlight); /* gold highlight */
  box-shadow: 0 0 10px var(--king-highlight);
}

.piece.king::after { /* Kept original content, font, color, shadow */
    content: 'K';
    font-size: 2.2em;
    font-weight: bold;
    color: var(--king-highlight);
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

/* --- Highlights (Retained from original, with color update) --- */
.highlight {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    background-color: var(--highlight-color);
    border-radius: 50%;
    transform: scale(0.6);
    opacity: 0.8;
    z-index: 50;
    transition: transform 0.1s ease-out;
}

.highlight.capture {
    background-color: var(--capture-highlight-color);
    animation: pulse-red 1s infinite alternate;
}

/* Hover highlight on squares (from new animations.css) */
.square:hover {
  outline: 2px solid var(--accent);
  outline-offset: -2px;
}

@keyframes pulse-red {
    from { transform: scale(0.6); opacity: 0.8; }
    to { transform: scale(0.7); opacity: 1; }
}

/* --- Online Menu Specific Styles (Kept mostly original, colors updated) --- */
#online-menu .online-setup-section,
#online-menu .sub-section {
    background-color: var(--bg-dark); /* Using new background color for inner sections */
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 12px;
    width: 95%;
    max-width: 450px;
    display: flex;
    flex-direction: column;
    align-items: center;
    border: 1px solid var(--dark-square); /* Added border for definition */
}

#online-menu label {
    display: block;
    margin: 10px 0 5px 0;
    font-weight: 600; /* Adjusted to 600 */
    color: var(--text-light);
    width: 100%;
    text-align: left;
}

#online-menu input[type="text"],
#online-menu input[type="password"],
#online-menu select {
    padding: 10px;
    margin: 5px 0;
    width: 100%;
    border: 1px solid var(--dark-square); /* Adjusted border color */
    border-radius: 5px;
    font-size: 1em;
    background-color: var(--text-light); /* Light background for inputs */
    color: var(--bg-dark); /* Dark text for inputs */
    box-sizing: border-box;
}

#online-menu select { height: 38px; }

#online-menu button {
    margin-top: 10px;
    width: auto;
    min-width: 120px;
    padding: 10px 20px;
    font-size: 1em;
}

#connection-status {
    font-size: 0.9em;
    margin-top: 10px;
    color: var(--text-light); /* Adjusted color */
}

#lobby-list {
    background-color: var(--bg-dark); /* Using new background color */
    border: 1px solid var(--dark-square); /* Adjusted border color */
    border-radius: 5px;
    max-height: 200px;
    overflow-y: auto;
    margin-bottom: 12px;
    padding: 10px;
    text-align: left;
    width: 95%;
    max-width: 450px;
}

#online-menu hr {
    width: 95%;
    border: none;
    border-top: 1px solid var(--dark-square); /* Adjusted border color */
    margin: 15px 0;
}

.online-explanation {
    max-width: 95%;
    font-size: 0.9em;
    color: var(--text-light); /* Adjusted color */
    margin-bottom: 15px;
}

.lobby-item {
    background-color: var(--bg-dark); /* Using new background color */
    border: 1px solid var(--dark-square); /* Adjusted border color */
    padding: 10px;
    margin-bottom: 8px;
    border-radius: 5px;
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.lobby-item:hover { background-color: var(--light-square); } /* Adjusted hover color */

.lobby-item span { flex-grow: 1; text-align: left; }
.lobby-item .player-count { font-weight: 600; margin-left: 10px; } /* Adjusted to 600 */
.lobby-item .lobby-status { font-size: 0.8em; color: var(--text-light); margin-left: 10px; } /* Adjusted color */

#current-lobby-details h5 { margin: 10px 0 5px 0; }
#lobby-details-players {
    list-style-type: none;
    padding: 0;
    width: 100%;
}
#lobby-details-players li {
    background-color: var(--bg-dark); /* Using new background color */
    padding: 8px;
    margin-bottom: 5px;
    border-radius: 4px;
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
}

.color-selection, .difficulty-selection {
    margin: 20px 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 450px;
}

.color-selection button {
    margin: 5px;
    padding: 10px 20px;
    font-size: 1em;
    min-width: 150px;
}
#btn-play-as-red { background-color: var(--piece-red-color); }
#btn-play-as-red:hover { background-color: #d63d3d; } /* Adjusted hover */
#btn-play-as-blue { background-color: var(--piece-blue-color); color: var(--bg-dark); } /* Adjusted for light piece color */
#btn-play-as-blue:hover { background-color: #65a1d3; } /* Adjusted hover */

.ready-button.ready { background-color: var(--accent); } /* Using new accent */
.ready-button.ready:hover { background-color: #27ae60; } /* Adjusted hover */
.ready-button.not-ready { background-color: var(--accent-highlight); } /* Using new highlight */
.ready-button.not-ready:hover { background-color: #d35400; } /* Adjusted hover */

#difficulty-header {
    margin: 10px 0 15px 0;
    color: var(--text-light);
}

/* --- Modal Styles (Updated from new menu-modal.css and animations.css) --- */
.modal-backdrop { /* Renamed from .modal-overlay to match new CSS */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(26, 32, 44, 0.6); /* New background color */
    z-index: 1000;
    opacity: 0; /* From new animations.css */
    transition: opacity 0.3s ease-out; /* From new animations.css */
    /* visibility: hidden; -- Removed, rely solely on opacity for transition */
}

.modal-backdrop.show { /* New class for showing backdrop */
    opacity: 1;
    /* visibility: visible; -- Removed */
}

.modal {
    position: fixed;
    top: 50%;
    left: 50%;
    width: 90%;
    max-width: 400px; /* New max-width */
    background: rgba(255, 255, 255, 0.05); /* Frosted glass background */
    backdrop-filter: blur(10px); /* Frosted glass blur */
    -webkit-backdrop-filter: blur(10px); /* Webkit support */
    border-radius: 12px; /* New border radius */
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6); /* New shadow */
    color: var(--text-light); /* New text color */
    padding: 2em; /* New padding */
    transform: translate(-50%, -50%); /* Centering */
    z-index: 1001;
    opacity: 0; /* From new animations.css */
    transition: opacity 0.3s ease-out, transform 0.3s ease-out; /* From new animations.css */
    display: flex; /* Ensure content stacks correctly (from original .modal) */
    flex-direction: column; /* Ensure content stacks correctly (from original .modal) */
    align-items: center; /* Ensure content stacks correctly (from original .modal) */
}

.modal.show { /* New class for showing modal */
    opacity: 1;
    transform: translate(-50%, -50%); /* Ensures it slides to center */
}

/* Removed .modal-content as it's no longer needed with new .modal styling */
/* .modal-content {
    width: 100%;
    text-align: center;
} */

.modal h4 { /* Target h4 directly within modal */
    color: var(--text-light);
    margin-top: 0;
    margin-bottom: 20px;
    font-size: 1.8em;
}

.modal p { /* Target p directly within modal */
    margin-bottom: 15px;
    color: var(--text-light); /* Adjusted color */
}

.modal input[type="text"],
.modal input[type="password"],
.modal select {
    width: calc(100% - 20px); /* Adjusted to consider modal padding */
    margin-bottom: 15px;
    background-color: var(--text-light); /* Light background for inputs */
    color: var(--bg-dark); /* Dark text for inputs */
    border: 1px solid var(--dark-square); /* Adjusted border color */
    padding: 10px;
    border-radius: 5px;
    font-size: 1em;
    box-sizing: border-box;
}

.modal button { /* Buttons inside modals */
    width: auto;
    min-width: 150px;
    margin-top: 5px;
    margin-bottom: 5px;
}

.close-btn { /* Renamed from .modal-close-button to match new CSS */
    position: absolute;
    top: 12px; /* New position */
    right: 12px; /* New position */
    background: transparent; /* New background */
    border: none;
    font-size: 1.25rem; /* New font size */
    color: var(--text-light); /* New color */
    cursor: pointer;
    line-height: 1;
    padding: 0;
    min-width: unset;
    width: auto;
    box-shadow: none;
    transform: none;
    margin: 0;
}

.close-btn:hover {
    color: var(--accent-highlight); /* New hover color */
    background: none;
    transform: none; /* Removed rotate on hover to be cleaner */
}

/* --- Media Queries (Combined and updated from new responsive.css and original) --- */
@media (max-width: 768px) {
    #game-container { width: 98vw; padding: 10px; }
    h1 { font-size: 1.8em; margin-bottom: 10px; }
    h2 { font-size: 1.5em; }
    #game-info { font-size: 1em; padding: 0; }
    #turn-indicator, #message-area, #btn-undo { margin: 5px auto; }

    #board-container.board { /* Target with new class */
        width: 100%; /* From new responsive.css */
        max-width: 350px; /* From new responsive.css */
        margin: 0 auto; /* From new responsive.css */
        border-width: 2px; /* From original */
    }
    .square { /* No fixed width/height, let grid handle it */ }
    .piece { width: 70%; height: 70%; } /* Adjusted piece size */
    button, .button { /* From new responsive.css */
        width: 100%;
        font-size: 1.1rem;
        padding: 1em;
        margin: 8px auto; /* Centered buttons */
    }
    .piece.king::after { font-size: 1.8em; }
    #online-menu .online-setup-section,
    #online-menu .sub-section,
    #lobby-list,
    #online-menu hr,
    .online-explanation {
        width: 100%;
        max-width: 100%;
    }
    .modal { /* From new responsive.css */
        width: 95%;
        max-width: 350px;
        padding: 1.5em;
    }
    .modal h4 { font-size: 1.5em; margin-bottom: 15px;}
}

@media (max-width: 480px) {
    h1 { font-size: 1.5em; }
    h2 { font-size: 1.2em; }
    .piece.king::after { font-size: 1.5em; }
    #game-info { font-size: 0.9em; flex-direction: column; }
    #btn-undo { margin-top: 10px; }
    .modal { padding: 1em; } /* Adjusted padding */
    .modal h4 { font-size: 1.3em;}
}